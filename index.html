<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUEBREI O SISTEMA - Gest√£o Total</title>
    <style>
        :root { --primary: #00ff88; --secondary: #007bff; --bg: #0a0a0a; --card-bg: #151515; --text: #ffffff; }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg); color: var(--text); margin: 0; overflow-x: hidden; }
        
        /* Notifica√ß√µes LADO ESQUERDO */
        #notif-box { position: fixed; top: 20px; left: 20px; z-index: 10000; }
        .toast { background: #1a1a1a; color: var(--primary); border-left: 5px solid var(--primary); padding: 15px 25px; margin-bottom: 10px; border-radius: 5px; box-shadow: 0 5px 15px rgba(0,0,0,0.5); animation: slideInLeft 0.3s forwards; font-weight: bold; font-size: 0.9em; }
        @keyframes slideInLeft { from { transform: translateX(-100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        header { background: #000; padding: 15px 5%; display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--secondary); }
        .logo-text { font-weight: 900; letter-spacing: -1px; color: var(--text); text-transform: uppercase; }
        .logo-text span { color: var(--secondary); }
        
        .container { max-width: 1100px; margin: 0 auto; padding: 20px; }
        
        #shop-view, #admin-view { display: block; }
        #admin-view { display: none; background: #0c0c0c; min-height: 100vh; }

        .admin-card { background: #1a1a1a; padding: 15px; border-radius: 8px; border: 1px solid #333; margin-bottom: 20px; }
        
        .btn { padding: 10px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; border: none; transition: 0.3s; }
        .btn-buy { background: transparent; border: 1px solid var(--secondary); color: var(--secondary); width: 100%; }
        .btn-add { background: var(--secondary); color: #fff; margin-top: 5px; }
        .btn-edit { background: #ffaa00; color: #000; font-size: 0.7em; padding: 5px 8px; margin-right: 5px; }
        .btn-del { background: #ff4444; color: white; padding: 5px 8px; font-size: 0.7em; border-radius: 3px; border: none; cursor: pointer; }

        input, select, textarea { background: #000; border: 1px solid #333; color: white; padding: 10px; border-radius: 5px; width: 100%; box-sizing: border-box; margin: 5px 0; }

        .category-title { border-left: 4px solid var(--secondary); padding-left: 15px; color: var(--text); text-transform: uppercase; margin-bottom: 20px; font-style: italic; }
        .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; }
        .product-card { background: var(--card-bg); border-radius: 12px; padding: 15px; text-align: center; border: 1px solid #222; }
        .product-img { width: 100%; height: 140px; object-fit: contain; margin-bottom: 10px; }

        /* Estilos de Tabela Admin */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.85em; }
        th, td { border: 1px solid #333; padding: 10px; text-align: left; }
        th { background: #000; color: var(--secondary); }

        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); justify-content: center; align-items: center; z-index: 1000; }
        .modal-content { background: #111; padding: 25px; width: 320px; border-radius: 15px; border: 1px solid var(--secondary); text-align: center; }
        
        #admin-login-box { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #111; padding: 30px; border: 1px solid var(--secondary); z-index: 10001; border-radius: 10px; text-align: center; }
    </style>
</head>
<body>

<div id="notif-box"></div>

<div id="admin-login-box">
    <h3 style="color:var(--secondary); margin-bottom: 20px;">ACESSO RESTRITO</h3>
    <input type="password" id="admin-pass-input" placeholder="Senha Administrativa">
    <button class="btn btn-add" style="width:100%; margin-top: 10px;" onclick="checkAdminLogin()">ENTRAR</button>
    <button class="btn" style="background:none; color:#555; width:100%; margin-top: 5px;" onclick="hideAdminLogin()">Fechar</button>
</div>

<div id="shop-view">
    <header>
        <h1 class="logo-text">QUEBREI O <span>SISTEMA</span></h1>
        <button class="btn" style="background:var(--secondary); color:#fff" onclick="openCart()">üõí CARRINHO (<span id="cart-count">0</span>)</button>
    </header>
    
    <div class="container">
        <div id="categories-container"></div>
        
        <div style="background: #111; padding: 25px; border-radius: 12px; margin-top: 60px; border: 1px solid #222;">
            <h2 style="color:var(--secondary); margin-top: 0;">üí¨ FEEDBACK DOS CLIENTES</h2>
            <div id="shop-reviews" style="max-height: 400px; overflow-y: auto; margin-bottom: 20px;"></div>
            <div style="border-top: 1px solid #333; padding-top: 20px;">
                <input type="text" id="rev-user" placeholder="Seu Nick">
                <textarea id="rev-msg" placeholder="Sua avalia√ß√£o..."></textarea>
                <button class="btn btn-buy" onclick="sendReview()">PUBLICAR AVALIA√á√ÉO</button>
            </div>
        </div>
    </div>
</div>

<div id="admin-view">
    <header style="border-bottom: 2px solid var(--secondary);">
        <h1 style="color:var(--secondary)">üõ† PAINEL DE CONTROLE</h1>
        <button class="btn btn-exit" style="background: #ff4444; color:white;" onclick="exitAdmin()">DESLOGAR</button>
    </header>

    <div class="container">
        <div class="admin-card">
            <h3 id="form-title">üì¶ Gerenciar Produto</h3>
            <input type="hidden" id="p-id">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <input type="text" id="p-name" placeholder="Nome do Item">
                <input type="number" id="p-price" placeholder="Pre√ßo (R$)">
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <select id="p-img-select">
                    <option value="glock.png">Glock</option>
                    <option value="ak.png">AK-47</option>
                    <option value="arma.png">Rifle HK</option>
                    <option value="fall.png">FAL</option>
                    <option value="furadeira.png">Furadeira</option>
                    <option value="c4.png">C4 / Bomba</option>
                    <option value="muni.png">Muni√ß√£o</option>
                </select>
                <select id="p-cat"></select>
            </div>
            <button class="btn btn-add" id="btn-save-prod" style="width:100%" onclick="saveProduct()">SALVAR PRODUTO</button>
            <button class="btn" id="btn-cancel-edit" style="width:100%; display:none; background:#333; color:#fff; margin-top:5px;" onclick="resetForm()">CANCELAR EDI√á√ÉO</button>
        </div>

        <div class="admin-card">
            <h3>üìã Invent√°rio de Produtos</h3>
            <div style="overflow-x: auto;">
                <table id="product-table">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Categoria</th>
                            <th>Pre√ßo</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="admin-product-list"></tbody>
                </table>
            </div>
        </div>

        <div class="admin-card">
            <h3>‚≠ê Gest√£o de Avalia√ß√µes</h3>
            <div id="admin-reviews-manage"></div>
        </div>
    </div>
</div>

<div id="cart-modal" class="modal">
    <div class="modal-content">
        <div id="cart-step-1">
            <h2 style="color:var(--secondary)">Finalizar Compra</h2>
            <input type="text" id="buy-discord" placeholder="Seu Nick do Discord">
            <button class="btn" style="background:var(--secondary); width:100%; color:#fff" onclick="processOrder()">GERAR PIX</button>
        </div>
        <div id="cart-step-2" style="display:none">
            <h2 style="color:var(--primary)">PAGAMENTO PIX</h2>
            <div style="background:#fff; color:#000; padding:15px; font-size:0.75em; word-break:break-all; border-radius: 8px; font-family: monospace;">9c176ab9-a6d6-4311-a0ea-21dd7481227f</div>
            <button class="btn" style="background:green; width:100%; color:#fff; margin-top:10px" onclick="closeCart()">CONCLU√çDO</button>
        </div>
    </div>
</div>

<footer><center><p onclick="showAdminLogin()" style="cursor:pointer; opacity:0.1; margin: 50px 0;">Acesso Administrativo</p></center></footer>

<script>
    const ADMIN_PASS = "270712";
    const BANNED_WORDS = ["quebrei o sistema", "quebreisistema", "cu", "pau", "merda", "lixo", "fake", "roubo", "admin", "suporte"];
    
    let db = JSON.parse(localStorage.getItem('qs_v2_db')) || {
        categories: ["Arsenal", "Utilit√°rios"],
        products: [
            {id: 1, cat: "Arsenal", name: "Glock Custom", price: 2.5, img: "glock.png"},
            {id: 2, cat: "Utilit√°rios", name: "Furadeira", price: 5.0, img: "furadeira.png"}
        ],
        logs: [],
        reviews: [{user: "Sistema", msg: "Bem-vindo √† QUEBREI O SISTEMA.", date: new Date().toLocaleString()}]
    };

    let cart = [];

    function pushNotif(msg) {
        const box = document.getElementById('notif-box');
        const t = document.createElement('div');
        t.className = 'toast'; t.innerText = msg;
        box.appendChild(t);
        setTimeout(() => { t.style.opacity = '0'; setTimeout(() => t.remove(), 500); }, 3000);
    }

    function save() {
        localStorage.setItem('qs_v2_db', JSON.stringify(db));
        render();
    }

    function render() {
        // Render Loja
        const shopCont = document.getElementById('categories-container');
        shopCont.innerHTML = db.categories.map(cat => `
            <div class="category-block">
                <h2 class="category-title">${cat}</h2>
                <div class="products-grid">
                    ${db.products.filter(p => p.cat === cat).map(p => `
                        <div class="product-card">
                            <img src="${p.img}" class="product-img">
                            <h4>${p.name}</h4>
                            <p style="color:var(--secondary); font-weight:bold;">R$ ${p.price.toFixed(2)}</p>
                            <button class="btn btn-buy" onclick="addToCart(${p.id})">ADICIONAR</button>
                        </div>
                    `).join('')}
                </div>
            </div>
        `).join('');

        // Render Coment√°rios Loja
        document.getElementById('shop-reviews').innerHTML = db.reviews.map(r => `
            <div style="background:#1a1a1a; padding:12px; margin-top:8px; border-radius:8px; border-left:3px solid var(--secondary)">
                <small style="color:#555; float:right; font-size: 0.7em;">${r.date}</small>
                <b style="color:var(--secondary)">${r.user}</b>: ${r.msg}
            </div>
        `).join('');

        // Render Admin - Tabela de Produtos
        document.getElementById('p-cat').innerHTML = db.categories.map(c => `<option value="${c}">${c}</option>`).join('');
        const prodList = document.getElementById('admin-product-list');
        prodList.innerHTML = db.products.map(p => `
            <tr>
                <td>${p.name}</td>
                <td>${p.cat}</td>
                <td>R$ ${p.price.toFixed(2)}</td>
                <td>
                    <button class="btn btn-edit" onclick="editProduct(${p.id})">Editar</button>
                    <button class="btn btn-del" onclick="deleteProduct(${p.id})">Excluir</button>
                </td>
            </tr>
        `).join('');

        // Render Admin - Reviews
        document.getElementById('admin-reviews-manage').innerHTML = db.reviews.map((r, i) => `
            <div style="font-size:0.8em; margin-bottom:5px; background:#000; padding:10px; border: 1px solid #222;">
                <button class="btn-del" onclick="delReview(${i})">DELETAR</button> | [${r.date}] <b>${r.user}</b>: ${r.msg}
            </div>
        `).join('');
    }

    // FUN√á√ïES DE PRODUTO (CRUD)
    function saveProduct() {
        const id = document.getElementById('p-id').value;
        const name = document.getElementById('p-name').value;
        const price = parseFloat(document.getElementById('p-price').value);
        const img = document.getElementById('p-img-select').value;
        const cat = document.getElementById('p-cat').value;

        if (!name || isNaN(price)) return pushNotif("Preencha todos os campos!");

        if (id) {
            // EDITAR
            const index = db.products.findIndex(p => p.id == id);
            db.products[index] = { id: parseInt(id), name, price, img, cat };
            pushNotif("Produto atualizado!");
        } else {
            // CRIAR
            db.products.push({ id: Date.now(), name, price, img, cat });
            pushNotif("Produto criado!");
        }
        
        resetForm();
        save();
    }

    function editProduct(id) {
        const p = db.products.find(prod => prod.id === id);
        document.getElementById('p-id').value = p.id;
        document.getElementById('p-name').value = p.name;
        document.getElementById('p-price').value = p.price;
        document.getElementById('p-img-select').value = p.img;
        document.getElementById('p-cat').value = p.cat;
        
        document.getElementById('form-title').innerText = "üìù Editando: " + p.name;
        document.getElementById('btn-save-prod').innerText = "ATUALIZAR MUDAN√áAS";
        document.getElementById('btn-cancel-edit').style.display = "block";
        window.scrollTo(0,0);
    }

    function deleteProduct(id) {
        db.products = db.products.filter(p => p.id !== id);
        save();
        pushNotif("Produto removido!");
    }

    function resetForm() {
        document.getElementById('p-id').value = "";
        document.getElementById('p-name').value = "";
        document.getElementById('p-price').value = "";
        document.getElementById('form-title').innerText = "üì¶ Gerenciar Produto";
        document.getElementById('btn-save-prod').innerText = "SALVAR PRODUTO";
        document.getElementById('btn-cancel-edit').style.display = "none";
    }

    // A√ß√µes de Loja e Login (Mantidas)
    function addToCart(id) {
        cart.push(db.products.find(x => x.id === id));
        document.getElementById('cart-count').innerText = cart.length;
        pushNotif("Item adicionado!");
    }

    function openCart() { 
        if(cart.length === 0) return pushNotif("Carrinho vazio!");
        document.getElementById('cart-modal').style.display='flex'; 
    }
    
    function closeCart() { document.getElementById('cart-modal').style.display='none'; }

    function processOrder() {
        const d = document.getElementById('buy-discord').value;
        if(!d) return pushNotif("Informe seu Discord!");
        db.logs.unshift({ date: new Date().toLocaleString(), discord: d, items: cart.map(i => i.name).join(', ') });
        save();
        document.getElementById('cart-step-1').style.display='none';
        document.getElementById('cart-step-2').style.display='block';
    }

    function sendReview() {
        const u = document.getElementById('rev-user').value;
        const m = document.getElementById('rev-msg').value;
        if(!u || !m) return pushNotif("Preencha os campos!");
        const check = (u + " " + m).toLowerCase();
        if(BANNED_WORDS.some(w => check.includes(w))) return pushNotif("Conte√∫do proibido!");
        db.reviews.unshift({user: u, msg: m, date: new Date().toLocaleString()});
        save();
        document.getElementById('rev-user').value=''; document.getElementById('rev-msg').value='';
        pushNotif("Avalia√ß√£o publicada!");
    }

    function showAdminLogin() { document.getElementById('admin-login-box').style.display = 'block'; }
    function hideAdminLogin() { document.getElementById('admin-login-box').style.display = 'none'; }
    function checkAdminLogin() {
        if(document.getElementById('admin-pass-input').value === ADMIN_PASS) {
            hideAdminLogin();
            document.getElementById('shop-view').style.display = 'none';
            document.getElementById('admin-view').style.display = 'block';
            pushNotif("Painel Liberado!");
        } else {
            pushNotif("Senha Incorreta!");
        }
    }
    function exitAdmin() {
        document.getElementById('shop-view').style.display = 'block';
        document.getElementById('admin-view').style.display = 'none';
    }
    function delReview(i) { db.reviews.splice(i, 1); save(); pushNotif("Removido!"); }

    render();
</script>
</body>
</html>
