<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bahamas Store | Painel Elite</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        :root { --primary: #FFD700; --bg-body: #0f1114; --bg-card: #191c21; --text-main: #ffffff; }
        body { background-color: var(--bg-body); color: var(--text-main); font-family: 'Montserrat', sans-serif; }
        
        .navbar { background: var(--bg-card); border-bottom: 2px solid var(--primary); padding: 15px 0; }
        .navbar-brand { font-weight: 900; color: var(--primary) !important; letter-spacing: 2px; }

        .view { display: none; }
        .view.active { display: block; }

        /* Card de Produto */
        .prod-card { background: var(--bg-card); border-radius: 15px; border: 1px solid #2d3139; overflow: hidden; transition: 0.3s; }
        .prod-card:hover { border-color: var(--primary); transform: translateY(-5px); }
        .price-tag { color: var(--primary); font-weight: 800; font-size: 1.2rem; }

        /* Chat do Ticket */
        .chat-container { background: #0a0b0d; border-radius: 10px; height: 300px; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; }
        .msg { padding: 8px 15px; border-radius: 15px; max-width: 80%; font-size: 0.9rem; }
        .msg.admin { background: var(--primary); color: #000; align-self: flex-start; }
        .msg.user { background: #323742; color: #fff; align-self: flex-end; }

        /* Admin Lateral */
        .admin-nav .btn { text-align: left; margin-bottom: 5px; color: #fff; border: 1px solid #2d3139; }
        .admin-nav .btn:hover, .admin-nav .btn.active { background: var(--primary); color: #000; }

        /* Rodapé */
        footer { background: #08090b; padding: 40px 0; border-top: 2px solid var(--primary); margin-top: 60px; }

        /* Carrinho */
        .cart-btn {
            position: fixed; bottom: 30px; right: 30px; background: var(--primary);
            width: 65px; height: 65px; border-radius: 50%; display: flex;
            align-items: center; justify-content: center; font-size: 1.6rem; cursor: pointer;
            z-index: 2000; color: #000; box-shadow: 0 5px 20px rgba(0,0,0,0.6);
        }
    </style>
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
        <div class="container">
            <a class="navbar-brand" href="#" onclick="showView('store')">BAHAMAS STORE</a>
            <div class="ms-auto d-flex gap-2">
                <button class="btn btn-outline-light btn-sm" onclick="showView('tickets')"><i class="fas fa-ticket-alt"></i> MEUS PEDIDOS</button>
                <button class="btn btn-warning btn-sm fw-bold" onclick="accessAdmin()"><i class="fas fa-user-shield"></i> ADMIN</button>
            </div>
        </div>
    </nav>

    <div id="view-store" class="view active container py-4">
        <div class="d-flex gap-2 overflow-auto mb-4 pb-2" id="cat-tabs"></div>
        <div class="row g-4" id="prod-grid"></div>
    </div>

    <div id="view-tickets" class="view container py-5">
        <h3 class="fw-bold mb-4 text-primary">Acompanhar Entrega</h3>
        <div class="row g-4" id="user-orders-list"></div>
    </div>

    <div id="view-admin" class="view container py-5">
        <div class="row">
            <div class="col-md-3 admin-nav d-flex flex-column">
                <h5 class="text-warning fw-bold mb-3">PAINEL ADM</h5>
                <button class="btn btn-sm active" onclick="showAdminTab('orders')">Gerenciar Pedidos</button>
                <button class="btn btn-sm" onclick="showAdminTab('categories')">Categorias</button>
                <button class="btn btn-sm" onclick="showAdminTab('products')">Produtos</button>
                <button class="btn btn-danger btn-sm mt-4" onclick="showView('store')">Sair do Painel</button>
            </div>
            <div class="col-md-9 border-start border-secondary ps-4">
                
                <div id="adm-tab-orders" class="adm-tab">
                    <h5 class="mb-4">Pedidos dos Clientes</h5>
                    <div id="adm-orders-list"></div>
                </div>

                <div id="adm-tab-categories" class="adm-tab d-none">
                    <h5>Categorias</h5>
                    <div class="input-group mb-3">
                        <input type="text" id="new-cat-name" class="form-control bg-dark text-white border-secondary" placeholder="Nome da Categoria">
                        <button class="btn btn-warning" onclick="addCategory()">Adicionar</button>
                    </div>
                    <div id="adm-cats-list"></div>
                </div>

                <div id="adm-tab-products" class="adm-tab d-none">
                    <h5>Novo Produto</h5>
                    <div class="bg-card p-3 rounded mb-4">
                        <div class="row g-2">
                            <div class="col-md-6"><input type="text" id="p-name" class="form-control form-control-sm bg-dark text-white" placeholder="Nome"></div>
                            <div class="col-md-6"><input type="number" id="p-price" class="form-control form-control-sm bg-dark text-white" placeholder="Preço"></div>
                            <div class="col-md-6">
                                <select id="p-cat" class="form-select form-select-sm bg-dark text-white"></select>
                            </div>
                            <div class="col-md-6"><input type="text" id="p-img" class="form-control form-control-sm bg-dark text-white" placeholder="URL Imagem"></div>
                            <div class="col-12"><button class="btn btn-warning btn-sm w-100 fw-bold" onclick="addProduct()">CADASTRAR PRODUTO</button></div>
                        </div>
                    </div>
                    <div id="adm-prods-list"></div>
                </div>

            </div>
        </div>
    </div>

    <div class="modal fade" id="cartModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content bg-card text-white border-0 shadow-lg">
                <div class="modal-header border-secondary">
                    <h5 class="fw-bold text-primary">Carrinho de Compras</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="cart-list-items"></div>
                    <div class="p-3 bg-dark rounded mt-3 text-center">
                        <p class="mb-1">Pagamento: <b>PIX</b> | Entrega: <b>< 24h</b></p>
                        <h4 class="text-primary fw-bold mb-0" id="cart-total-text">Total: R$ 0,00</h4>
                    </div>
                </div>
                <div class="modal-footer border-0">
                    <button class="btn btn-warning w-100 py-3 fw-bold" onclick="finalizeOrder()">FINALIZAR COMPRA VIA PIX</button>
                </div>
            </div>
        </div>
    </div>

    <div class="cart-btn" onclick="openCart()">
        <i class="fas fa-shopping-basket"></i>
        <span id="cart-badge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="font-size: 0.8rem;">0</span>
    </div>

    <footer>
        <div class="container text-center">
            <h5 class="text-primary fw-bold mb-3">BAHAMAS STORE</h5>
            <p class="text-secondary small mb-4">Entrega digital em menos de 24 horas. Pagamentos 100% seguros via PIX.</p>
            <div class="d-flex justify-content-center gap-4 text-white-50 small">
                <span><i class="fas fa-check-circle text-success"></i> 100% Confiável</span>
                <span><i class="fas fa-bolt text-warning"></i> Entrega Rápida</span>
                <span><i class="fas fa-lock text-info"></i> Proteção de Dados</span>
            </div>
            <hr class="border-secondary my-4">
            <p class="small text-secondary mb-0">© 2024 Bahamas Store - Todos os direitos reservados.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // --- BANCO DE DADOS ---
        let db = JSON.parse(localStorage.getItem('bahamas_final_db')) || {
            categories: ["Vips", "Carros"],
            products: [{id: 1, name: "VIP Bahamas Gold", price: 100, cat: "Vips", img: "https://via.placeholder.com/300x150"}],
            orders: []
        };
        let cart = [];

        function save() { 
            localStorage.setItem('bahamas_final_db', JSON.stringify(db)); 
            renderStore();
            renderAdminLists();
        }

        // --- NAVEGAÇÃO ---
        function showView(v) {
            document.querySelectorAll('.view').forEach(el => el.classList.remove('active'));
            document.getElementById('view-' + v).classList.add('active');
            if(v === 'tickets') renderUserOrders();
        }

        function showAdminTab(t) {
            document.querySelectorAll('.adm-tab').forEach(el => el.classList.add('d-none'));
            document.getElementById('adm-tab-' + t).classList.remove('d-none');
            document.querySelectorAll('.admin-nav .btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
        }

        // --- ADMIN LÓGICA ---
        function accessAdmin() {
            Swal.fire({
                title: 'Senha Admin',
                input: 'password',
                confirmButtonColor: '#FFD700',
                background: '#191c21',
                color: '#fff'
            }).then(r => {
                if(r.value === '2707') showView('admin');
                else if(r.isConfirmed) Swal.fire('Erro', 'Senha Incorreta', 'error');
            });
        }

        function addCategory() {
            const name = document.getElementById('new-cat-name').value;
            if(name) { db.categories.push(name); document.getElementById('new-cat-name').value = ''; save(); }
        }

        function addProduct() {
            const n = document.getElementById('p-name').value;
            const p = document.getElementById('p-price').value;
            const c = document.getElementById('p-cat').value;
            const i = document.getElementById('p-img').value;
            if(n && p) {
                db.products.push({ id: Date.now(), name: n, price: p, cat: c, img: i || 'https://via.placeholder.com/300x150' });
                save();
            }
        }

        function renderAdminLists() {
            // Categorias
            document.getElementById('adm-cats-list').innerHTML = db.categories.map(c => `<div class="p-2 border-bottom border-secondary d-flex justify-content-between"><span>${c}</span><i class="fas fa-trash text-danger" style="cursor:pointer" onclick="db.categories=db.categories.filter(x=>x!=='${c}');save();"></i></div>`).join('');
            
            // Select de Categorias no cadastro
            document.getElementById('p-cat').innerHTML = db.categories.map(c => `<option value="${c}">${c}</option>`).join('');

            // Lista de Produtos
            document.getElementById('adm-prods-list').innerHTML = db.products.map(p => `<div class="p-2 border-bottom border-secondary d-flex justify-content-between"><span>${p.name} (R$ ${p.price})</span><button class="btn btn-danger btn-sm" onclick="db.products=db.products.filter(x=>x.id!==${p.id});save();">Remover</button></div>`).join('');

            // Lista de Pedidos
            document.getElementById('adm-orders-list').innerHTML = db.orders.map(o => `
                <div class="bg-card p-3 mb-2 rounded border border-secondary">
                    <div class="d-flex justify-content-between align-items-center">
                        <b>Pedido #${o.id} - R$ ${o.total}</b>
                        <span class="badge ${o.status === 'Entregue' ? 'bg-success' : 'bg-warning'}">${o.status}</span>
                    </div>
                    <div class="mt-2">
                        <button class="btn btn-sm btn-outline-info" onclick="changeStatus(${o.id})">Mudar Status</button>
                    </div>
                </div>
            `).join('');
        }

        function changeStatus(id) {
            const o = db.orders.find(x => x.id === id);
            o.status = o.status === 'Entregue' ? 'Aguardando Comprovante' : 'Entregue';
            save();
        }

        // --- LOJA & CARRINHO ---
        function renderStore() {
            const grid = document.getElementById('prod-grid');
            grid.innerHTML = db.products.map(p => `
                <div class="col-6 col-md-4">
                    <div class="prod-card shadow">
                        <img src="${p.img}" class="w-100" style="height:150px; object-fit:cover">
                        <div class="p-3">
                            <h6 class="fw-bold mb-1">${p.name}</h6>
                            <p class="small text-secondary mb-2">${p.cat}</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="price-tag">R$ ${p.price}</span>
                                <button class="btn btn-sm btn-warning" onclick="addToCart(${p.id})"><i class="fas fa-plus"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function addToCart(id) {
            const p = db.products.find(x => x.id === id);
            cart.push({...p, cartId: Date.now()});
            document.getElementById('cart-badge').innerText = cart.length;
            Swal.fire({ toast: true, position: 'top-end', icon: 'success', title: 'Adicionado!', showConfirmButton: false, timer: 1000 });
        }

        function openCart() {
            const list = document.getElementById('cart-list-items');
            let total = 0;
            list.innerHTML = cart.map(i => {
                total += parseFloat(i.price);
                return `<div class="d-flex justify-content-between mb-2"><span>${i.name}</span><b>R$ ${i.price}</b></div>`;
            }).join('');
            document.getElementById('cart-total-text').innerText = `Total: R$ ${total.toFixed(2)}`;
            new bootstrap.Modal(document.getElementById('cartModal')).show();
        }

        function finalizeOrder() {
            if(!cart.length) return;
            const orderId = Math.floor(1000 + Math.random() * 9000);
            const total = cart.reduce((a,b) => a + parseFloat(b.price), 0);
            db.orders.push({ id: orderId, total: total.toFixed(2), status: 'Aguardando Comprovante', date: new Date().toLocaleString() });
            cart = [];
            document.getElementById('cart-badge').innerText = 0;
            save();
            bootstrap.Modal.getInstance(document.getElementById('cartModal')).hide();
            Swal.fire('Pedido Criado!', 'Siga para a aba "Meus Pedidos" para entrega.', 'success');
            showView('tickets');
        }

        function renderUserOrders() {
            const list = document.getElementById('user-orders-list');
            list.innerHTML = db.orders.map(o => `
                <div class="col-md-6">
                    <div class="bg-card p-4 rounded border border-secondary shadow">
                        <div class="d-flex justify-content-between mb-3">
                            <h5 class="fw-bold text-primary mb-0">Ticket #${o.id}</h5>
                            <span class="badge bg-warning text-dark">${o.status}</span>
                        </div>
                        <div class="chat-container mb-3">
                            <div class="msg admin">Olá! Por favor, anexe o comprovante do PIX para o valor de R$ ${o.total} e aguarde nossa equipe entregar seu produto.</div>
                            ${o.status === 'Entregue' ? '<div class="msg admin">Seu produto foi entregue com sucesso! Obrigado pela compra.</div>' : ''}
                        </div>
                        <p class="small text-secondary">ID Transação: PIX-ORDER-${o.id}</p>
                    </div>
                </div>
            `).join('');
        }

        // Início
        renderStore();
        renderAdminLists();
    </script>
</body>
</html>
